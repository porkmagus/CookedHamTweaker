<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>üê∑ CookedHamTweaker v2 ‚Äì Windows Optimization</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
            background: radial-gradient(circle at top, #1e1b4b 0, #020617 55%);
            color: #e5e7eb;
            min-height: 100vh;
        }

        .app-shell {
            max-width: 1320px;
            margin: 0 auto;
            padding: 24px 16px 40px;
            position: relative;
            z-index: 1;
        }

        header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .pig-badge {
            width: 64px;
            height: 64px;
            border-radius: 999px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            background: radial-gradient(circle at 30% 30%, #fecaca 0, #fb7185 40%, #9f1239 100%);
            box-shadow: 0 0 35px rgba(248, 113, 113, 0.45);
        }

        .headline {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .headline h1 {
            font-size: 1.9rem;
            letter-spacing: 0.03em;
        }

        .headline small {
            font-size: 0.85rem;
            color: #9ca3af;
        }

        .pill-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 18px;
        }

        .pill {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.4);
            background: linear-gradient(to right, rgba(15, 23, 42, 0.85), rgba(31, 41, 55, 0.85));
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            color: #e5e7eb;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .pill span {
            font-size: 0.9em;
            color: #9ca3af;
        }

        .layout {
            display: grid;
            grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.1fr);
            gap: 18px;
        }

        @media (max-width: 980px) {
            .layout {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .card {
            background: radial-gradient(circle at top left, rgba(248, 113, 113, 0.12), transparent 55%);
            background-color: rgba(15, 23, 42, 0.9);
            border-radius: 16px;
            border: 1px solid rgba(148, 163, 184, 0.55);
            box-shadow: 0 22px 45px rgba(15, 23, 42, 0.9);
            padding: 14px 14px 12px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-header h2 {
            font-size: 0.95rem;
            letter-spacing: 0.06em;
            text-transform: uppercase;
            color: #a5b4fc;
        }

        .card-header small {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .stats-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stat-chip {
            flex: 1 1 90px;
            min-width: 0;
            border-radius: 999px;
            padding: 6px 10px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(to right, #020617, #111827);
            border: 1px solid rgba(55, 65, 81, 0.9);
        }

        .stat-chip strong {
            color: #f97316;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
            gap: 10px;
            margin-top: 8px;
        }

        @media (max-width: 620px) {
            .grid-2 {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .field label {
            font-size: 0.75rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: #9ca3af;
        }

        /* UPDATED: darker select dropdown */
        select,
        input[type="text"] {
            border-radius: 999px;
            border: 1px solid rgba(55, 65, 81, 0.95);
            background: #020617;
            color: #e5e7eb;
            font-size: 0.85rem;
            padding: 8px 11px;
            outline: none;
            appearance: none;
        }

        select:focus,
        input[type="text"]:focus {
            border-color: #f97316;
            box-shadow: 0 0 0 1px rgba(249, 115, 22, 0.4);
        }

        /* Dark dropdown options */
        select option {
            background-color: #020617;
            color: #e5e7eb;
        }

        .btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        button {
            border: none;
            cursor: pointer;
            border-radius: 999px;
            font-size: 0.8rem;
            padding: 7px 14px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.15s ease;
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, #fb7185, #f97316);
            color: #020617;
            font-weight: 600;
            box-shadow: 0 14px 35px rgba(248, 113, 113, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 18px 40px rgba(248, 113, 113, 0.5);
        }

        .btn-ghost {
            background: rgba(15, 23, 42, 0.9);
            color: #e5e7eb;
            border: 1px solid rgba(55, 65, 81, 0.95);
        }

        .btn-ghost:hover {
            background: rgba(31, 41, 55, 0.9);
        }

        .categories-wrap {
            margin-top: 12px;
            border-radius: 14px;
            border: 1px solid rgba(55, 65, 81, 0.9);
            background: radial-gradient(circle at top left, rgba(30, 64, 175, 0.45), #020617 55%);
            padding: 10px;
            max-height: 540px;
            overflow-y: auto;
        }

        .category-block {
            border-radius: 10px;
            margin-bottom: 8px;
            overflow: hidden;
            border: 1px solid rgba(55, 65, 81, 0.85);
            background: rgba(15, 23, 42, 0.95);
        }

        .category-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            cursor: pointer;
            background: linear-gradient(to right, rgba(15, 23, 42, 0.95), rgba(30, 64, 175, 0.7));
        }

        .category-head-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-head-title {
            font-size: 0.85rem;
            font-weight: 600;
        }

        .category-pill {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.6);
            color: #e5e7eb;
        }

        .category-chevron {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .tweaks-list {
            max-height: 420px;
            overflow-y: auto;
            padding: 4px 2px 6px;
        }

        .tweak-item {
            display: flex;
            gap: 8px;
            padding: 6px 9px;
            border-bottom: 1px solid rgba(31, 41, 55, 0.95);
            cursor: pointer;
        }

        .tweak-item:last-child {
            border-bottom: none;
        }

        .tweak-item:hover {
            background: rgba(15, 23, 42, 0.85);
        }

        .tweak-item input[type="checkbox"] {
            margin-top: 3px;
            cursor: pointer;
        }

        .tweak-main {
            flex: 1;
        }

        .tweak-name {
            font-size: 0.82rem;
            font-weight: 600;
            color: #e5e7eb;
        }

        .tweak-desc {
            font-size: 0.72rem;
            color: #9ca3af;
        }

        .code-panel {
            background: radial-gradient(circle at top right, rgba(56, 189, 248, 0.23), #020617 55%);
            border-radius: 16px;
            border: 1px solid rgba(55, 65, 81, 0.98);
            padding: 14px;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .code-header h2 {
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #a5b4fc;
        }

        .code-header span {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .code-box {
            flex: 1;
            margin-top: 4px;
            border-radius: 10px;
            background: rgba(15, 23, 42, 0.96);
            border: 1px solid rgba(31, 41, 55, 0.98);
            padding: 10px;
            overflow-y: auto;
            max-height: 360px;
        }

        pre {
            font-family: Consolas, "Cascadia Code", Menlo, monospace;
            font-size: 0.78rem;
            color: #7dd3fc;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .code-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: flex-end;
        }



        /* FLOATING PIGS */
        .floating-pig {
            position: fixed;
            font-size: 2.4rem;
            pointer-events: none;
            z-index: 9999;
            animation: floatPig 10s ease-in-out infinite;
            opacity: 0.75;
        }

        .floating-pig.pig-1 {
            left: 8%;
            top: 18%;
            animation-duration: 13s;
        }

        .floating-pig.pig-2 {
            right: 12%;
            top: 30%;
            animation-duration: 11s;
        }

        .floating-pig.pig-3 {
            left: 18%;
            bottom: 12%;
            animation-duration: 15s;
        }

        @keyframes floatPig {
            0% {
                transform: translateY(0) translateX(0) scale(1);
            }
            25% {
                transform: translateY(-18px) translateX(8px) scale(1.05);
            }
            50% {
                transform: translateY(-4px) translateX(-6px) scale(0.98);
            }
            75% {
                transform: translateY(-22px) translateX(4px) scale(1.04);
            }
            100% {
                transform: translateY(0) translateX(0) scale(1);
            }
        }

        .github-link {
            margin-top: 12px;
            text-align: center;
            font-size: 0.9rem;
        }

        .github-link a {
            color: #f97316;
            text-decoration: none;
            position: relative;
        }

        .github-link a:hover {
            color: #fb7185;
        }

        .github-link a:after {
            content: " ";
            display: block;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, transparent, #f97316, transparent);
            position: absolute;
            top: 100%;
            left: 0;
            z-index: 1;
        }

        /* Responsive adjustments */
        @media (max-width: 720px) {
            .app-shell {
                padding: 24px 12px 32px;
            }

            header {
                flex-direction: column;
                align-items: flex-start;
            }

            .pill-row {
                flex-direction: column;
                gap: 12px;
                margin-bottom: 16px;
            }

            .card {
                padding: 12px;
            }

            .code-panel {
                padding: 12px;
            }
        }

        .changelog {
            margin-top: 20px;
            padding: 12px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .changelog-version {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #f97316;
        }

        .changelog-list {
            list-style-type: none;
            padding-left: 0;
            color: #e5e7eb;
        }

        .changelog-list li {
            position: relative;
            padding-left: 18px;
            margin-bottom: 4px;
        }

        .changelog-list li:before {
            content: "‚úîÔ∏è";
            position: absolute;
            left: 0;
            top: 1px;
            font-size: 0.9rem;
            color: #4ade80;
        }
    </style>
</head>
<body>
<div class="app-shell">
    <header>
        <div class="pig-badge">üê∑</div>
        <div class="headline">
            <h1>CookedHamTweaker v2</h1>
            <small>Opinionated Windows 11 privacy, debloat, and performance script generator.</small>
        </div>
    </header>

    <div class="pill-row">
        <div class="pill">üêñ <span>Crisp your Windows install like bacon, not your telemetry.</span></div>
        <div class="pill">üßØ <span>No ads, no suggestions, no nags.</span></div>
        <div class="pill">üéÆ <span>Low-latency gaming and snappy UI.</span></div>
    </div>

    <div class="layout">
        <!-- LEFT: Controls + Categories -->
        <div class="card">
            <div class="card-header">
                <h2>Profile & Filters</h2>
                <small><span id="totalCountLabel">0</span> tweaks ¬∑ <span id="selectedCountLabel">0</span> selected</small>
            </div>

            <div class="stats-row">
                <div class="stat-chip">
                    <span>Privacy</span>
                    <strong id="statPrivacy">0</strong>
                </div>
                <div class="stat-chip">
                    <span>Perf</span>
                    <strong id="statPerformance">0</strong>
                </div>
                <div class="stat-chip">
                    <span>Power</span>
                    <strong id="statPower">0</strong>
                </div>
                <div class="stat-chip">
                    <span>UI</span>
                    <strong id="statUi">0</strong>
                </div>
                <div class="stat-chip">
                    <span>Services</span>
                    <strong id="statServices">0</strong>
                </div>
                <div class="stat-chip">
                    <span>Updates</span>
                    <strong id="statUpdates">0</strong>
                </div>
                <div class="stat-chip">
                    <span>Notifs</span>
                    <strong id="statNotifications">0</strong>
                </div>
                <div class="stat-chip">
                    <span>Bloat</span>
                    <strong id="statBloatware">0</strong>
                </div>
            </div>

            <div class="grid-2">
                <div class="field">
                    <label for="profileSelect">Profile</label>
                    <select id="profileSelect">
                        <option value="">Manual selection</option>
                        <option value="privacy">üîí Hardcore privacy</option>
                        <option value="gaming">üéÆ Gaming focused</option>
                        <option value="balanced">‚öñÔ∏è Balanced</option>
                        <option value="maximum">üöÄ Max everything</option>
                    </select>
                </div>
                <div class="field">
                    <label for="searchInput">Search tweaks</label>
                    <input type="text" id="searchInput" placeholder="Filter by name or description..." />
                </div>
            </div>

            <div class="btn-row">
                <button class="btn-primary" type="button" onclick="selectAllTweaks()">Select all visible</button>
                <button class="btn-ghost" type="button" onclick="clearAllTweaks()">Clear all</button>
            </div>

            <div class="categories-wrap" id="categoriesContainer">
                <!-- Populated by JS -->
            </div>
        </div>

        <!-- RIGHT: Script output -->
        <div class="code-panel">
            <div class="code-header">
                <div>
                    <h2>Generated Script</h2>
                    <span>PowerShell-safe commands ¬∑ Run as Administrator</span>
                </div>
            </div>
            <div class="code-box">
                <pre id="scriptCode"># Select tweaks on the left to generate a script...</pre>
            </div>
            <div class="code-actions">
                <button class="btn-ghost" type="button" onclick="clearScript()">üóë Clear</button>
                <button class="btn-ghost" type="button" onclick="copyScript()">üìã Copy</button>
                <button class="btn-primary" type="button" onclick="downloadScript()">‚¨áÔ∏è Download .ps1</button>
            </div>
            <div class="github-link">
                <a href="https://github.com/porkmagus/CookedHamTweaker" target="_blank" rel="noopener noreferrer">
                    üê∑ Fork this pig on GitHub üêΩ
                </a>
            </div>
            <div class="changelog">
                <div class="changelog-version">v2.0.0</div>
                <ul class="changelog-list">
                    <li>üê∑ Major update with HamTweak.ps1 integration</li>
                    <li>üîí Privacy & Security tweaks</li>
                    <li>‚ö° Performance optimizations</li>
                    <li>üîã Power management tweaks</li>
                    <li>üé® UI & Visual customizations</li>
                    <li>‚öôÔ∏è Windows Services control</li>
                    <li>üîÑ Windows Updates settings</li>
                    <li>üîî Notification tweaks</li>
                    <li>üßπ Bloatware removal</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Floating pigs -->
<div class="floating-pig pig-1">üê∑</div>
<div class="floating-pig pig-2">üêΩ</div>
<div class="floating-pig pig-3">üê∑</div>

<script>
const tweaksData = {
    // ===================================================================================
    // PRIVACY & SECURITY - From HamTweak.ps1
    // ===================================================================================
    privacy: [
        // --- Advertising & Tracking ---
        { name: "Master Ads Control", desc: "Disable all Microsoft ads and promotional content", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f' },
        { name: "Disable Personalized Ads", desc: "Turn off behavioral ad targeting", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Advertising ID", desc: "Reset and disable advertising identifier", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AdvertisingInfo" /v DisabledByGroupPolicy /t REG_DWORD /d 1 /f' },
        { name: "Disable App Launch Tracking", desc: "Stop tracking which apps you launch", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v Start_TrackProgs /t REG_DWORD /d 0 /f' },
        { name: "Disable Content Delivery", desc: "Stop dynamic content downloads", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v ContentDeliveryAllowed /t REG_DWORD /d 0 /f' },
        { name: "Disable Subscribed Content", desc: "Remove Microsoft suggestions", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SubscribedContentEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable App Suggestions", desc: "Turn off suggested apps in Start", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SystemPaneSuggestionsEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Pre-installed Apps", desc: "Stop silent app installations", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v PreInstalledAppsEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable OEM Pre-installed Apps", desc: "Block OEM bloatware installation", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v OemPreInstalledAppsEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Silent App Install", desc: "Prevent background app installs", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SilentInstalledAppsEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Feature Management", desc: "Stop Microsoft feature experiments", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v FeatureManagementEnabled /t REG_DWORD /d 0 /f' },
        
        // --- Lock Screen Privacy ---
        { name: "Disable Windows Spotlight", desc: "Turn off rotating lock screen images", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v RotatingLockScreenEnabled /t REG_DWORD /d 0 /f\nreg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v RotatingLockScreenOverlayEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Lock Screen Fun Facts", desc: "Remove tips from lock screen", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SubscribedContent-338387Enabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Lock Screen Notifications", desc: "Hide notifications on locked screen", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Notifications\\Settings" /v NOC_GLOBAL_SETTING_ALLOW_TOASTS_ABOVE_LOCK /t REG_DWORD /d 0 /f' },
        
        // --- Speech & Voice ---
        { name: "Disable Online Speech Recognition", desc: "Keep speech processing local", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Speech_OneCore\\Settings\\OnlineSpeechPrivacy" /v HasAccepted /t REG_DWORD /d 0 /f' },
        { name: "Disable Cortana", desc: "Turn off Cortana assistant", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f' },
        { name: "Disable Voice Activation", desc: "Turn off Hey Cortana wake phrase", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Speech_OneCore\\Preferences" /v VoiceActivationEnableAboveLockscreen /t REG_DWORD /d 0 /f' },
        
        // --- Input & Typing ---
        { name: "Disable Inking Personalization", desc: "Stop learning from handwriting", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\InputPersonalization" /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f' },
        { name: "Disable Typing Personalization", desc: "Stop learning from typing patterns", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\InputPersonalization" /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f' },
        { name: "Disable Input Telemetry", desc: "Stop sending typing data to MS", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Input\\TIPC" /v Enabled /t REG_DWORD /d 0 /f' },
        
        // --- Telemetry & Diagnostics ---
        { name: "Set Telemetry to Basic", desc: "Minimize diagnostic data collection", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v AllowTelemetry /t REG_DWORD /d 1 /f' },
        { name: "Disable Telemetry (RISK)", desc: "Turn off all diagnostic data - may break features", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f', risk: true },
        { name: "Disable Feedback Requests", desc: "Stop Windows feedback prompts", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Siuf\\Rules" /v NumberOfSIUFInPeriod /t REG_DWORD /d 0 /f' },
        { name: "Disable Tailored Experiences", desc: "Stop personalized tips based on data", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Privacy" /v TailoredExperiencesWithDiagnosticDataEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Error Reporting", desc: "Dont send crash reports to Microsoft", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting" /v Disabled /t REG_DWORD /d 1 /f' },
        { name: "Disable CEIP", desc: "Opt out of Customer Experience Program", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows" /v CEIPEnable /t REG_DWORD /d 0 /f' },
        
        // --- Location & Sensors ---
        { name: "Disable Location Services", desc: "Turn off location tracking", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors" /v DisableLocation /t REG_DWORD /d 1 /f' },
        { name: "Disable Location Scripting", desc: "Prevent apps from using location", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors" /v DisableLocationScripting /t REG_DWORD /d 1 /f' },
        
        // --- Camera & Microphone ---
        { name: "Disable Camera Access", desc: "Block apps from using camera", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy" /v LetAppsAccessCamera /t REG_DWORD /d 2 /f' },
        { name: "Disable Microphone Access", desc: "Block apps from using microphone", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy" /v LetAppsAccessMicrophone /t REG_DWORD /d 2 /f' },
        
        // --- Account & Sync ---
        { name: "Disable Activity History", desc: "Stop tracking your activities", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System" /v EnableActivityFeed /t REG_DWORD /d 0 /f\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System" /v PublishUserActivities /t REG_DWORD /d 0 /f' },
        { name: "Disable Timeline", desc: "Turn off activity timeline feature", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System" /v EnableActivityFeed /t REG_DWORD /d 0 /f' },
        { name: "Disable Settings Sync", desc: "Dont sync settings across devices", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync" /v SyncPolicy /t REG_DWORD /d 5 /f' },
        { name: "Disable Clipboard Sync", desc: "Dont sync clipboard across devices", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Clipboard" /v EnableClipboardHistory /t REG_DWORD /d 0 /f' },
        
        // --- Security Settings ---
        { name: "Lower UAC (RISK)", desc: "Reduce security prompts - less secure", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" /v ConsentPromptBehaviorAdmin /t REG_DWORD /d 0 /f', risk: true },
        { name: "Normal UAC", desc: "Standard User Account Control", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" /v ConsentPromptBehaviorAdmin /t REG_DWORD /d 5 /f' },
        { name: "Disable Remote Assistance", desc: "Turn off remote help feature", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Remote Assistance" /v fAllowToGetHelp /t REG_DWORD /d 0 /f' },
        { name: "Disable Remote Desktop", desc: "Turn off remote desktop access", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 1 /f' },
        
        // --- Additional Privacy ---
        { name: "Disable Copilot Button", desc: "Removes Copilot from taskbar", cmd: 'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v ShowCopilotButton /t REG_DWORD /d 0 /f' },
        { name: "Disable Recall Feature", desc: "Disables Recall AI snapshots", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsAI" /v DisableAIDataAnalysis /t REG_DWORD /d 1 /f' },
        { name: "Disable Wi-Fi Sense", desc: "Prevents WiFi credential sharing", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\WcmSvc\\wifinetworkmanager\\config" /v AutoConnectAllowedOEM /t REG_DWORD /d 0 /f' }
    ],

    // ===================================================================================
    // PERFORMANCE & GAMING - From HamTweak.ps1
    // ===================================================================================
    performance: [
        // --- Game Mode & Gaming ---
        { name: "Enable Game Mode", desc: "Optimize system for gaming", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\GameBar" /v AutoGameModeEnabled /t REG_DWORD /d 1 /f' },
        { name: "Disable Game Bar", desc: "Turn off Xbox game overlay", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameDVR" /v AppCaptureEnabled /t REG_DWORD /d 0 /f\nreg add "HKCU\\SOFTWARE\\Microsoft\\GameBar" /v UseNexusForGameBarEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Game DVR", desc: "Stop background game recording", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\GameDVR" /v AllowGameDVR /t REG_DWORD /d 0 /f' },
        { name: "Disable Game Bar Tips", desc: "Remove gaming overlay tips", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\GameBar" /v ShowStartupPanel /t REG_DWORD /d 0 /f' },
        { name: "Disable Fullscreen Optimizations", desc: "Legacy fullscreen for older games", cmd: 'reg add "HKCU\\System\\GameConfigStore" /v GameDVR_FSEBehaviorMode /t REG_DWORD /d 2 /f' },
        { name: "GPU High Priority", desc: "Prioritize graphics processing", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile\\Tasks\\Games" /v "GPU Priority" /t REG_DWORD /d 8 /f' },
        { name: "Game Process Priority", desc: "Higher CPU priority for games", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile\\Tasks\\Games" /v Priority /t REG_DWORD /d 6 /f' },
        { name: "Game Scheduling Category", desc: "Optimize thread scheduling for games", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile\\Tasks\\Games" /v "Scheduling Category" /t REG_SZ /d High /f' },
        { name: "Enable Hardware Acceleration", desc: "Use GPU for rendering", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Avalon.Graphics" /v DisableHWAcceleration /t REG_DWORD /d 0 /f' },
        { name: "Enable Variable Refresh Rate", desc: "G-Sync/FreeSync support", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\DirectX\\UserGpuPreferences" /v VRROptimizeEnable /t REG_DWORD /d 1 /f' },
        { name: "Enable HAGS", desc: "Hardware Accelerated GPU Scheduling", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\GraphicsDrivers" /v HwSchMode /t REG_DWORD /d 2 /f' },
        { name: "Disable Network Throttling", desc: "Full bandwidth for applications", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile" /v NetworkThrottlingIndex /t REG_DWORD /d 4294967295 /f' },
        { name: "System Responsiveness", desc: "Prioritize foreground applications", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile" /v SystemResponsiveness /t REG_DWORD /d 0 /f' },
        { name: "Foreground App Boost", desc: "CPU priority for active window", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\PriorityControl" /v Win32PrioritySeparation /t REG_DWORD /d 38 /f' },
        { name: "Large System Cache", desc: "Optimize memory for applications", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management" /v LargeSystemCache /t REG_DWORD /d 0 /f' },
        { name: "Disable Paging Executive", desc: "Keep drivers in RAM", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management" /v DisablePagingExecutive /t REG_DWORD /d 1 /f' },
        { name: "NTFS Memory Usage", desc: "Optimize NTFS for performance", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem" /v NtfsMemoryUsage /t REG_DWORD /d 2 /f' },
        { name: "Disable Last Access Update", desc: "Reduce disk writes", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem" /v NtfsDisableLastAccessUpdate /t REG_DWORD /d 1 /f' },
        { name: "Disable 8.3 Filenames", desc: "Improve NTFS performance", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem" /v NtfsDisable8dot3NameCreation /t REG_DWORD /d 1 /f' },
        { name: "Optimize Prefetch for SSD", desc: "Configure prefetch for SSD", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters" /v EnablePrefetcher /t REG_DWORD /d 0 /f' },
        { name: "Optimize Superfetch for SSD", desc: "Configure superfetch for SSD", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters" /v EnableSuperfetch /t REG_DWORD /d 0 /f' },
        { name: "Best Performance Visual FX", desc: "Disable animations for speed", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VisualEffects" /v VisualFXSetting /t REG_DWORD /d 2 /f' },
        { name: "Instant Menu Display", desc: "Faster menu appearance", cmd: 'reg add "HKCU\\Control Panel\\Desktop" /v MenuShowDelay /t REG_SZ /d 0 /f' },
        { name: "Disable Window Animations", desc: "Turn off minimize/maximize effects", cmd: 'reg add "HKCU\\Control Panel\\Desktop\\WindowMetrics" /v MinAnimate /t REG_SZ /d 0 /f' },
        { name: "Disable Cursor Blink", desc: "Static cursor for less CPU", cmd: 'reg add "HKCU\\Control Panel\\Desktop" /v CursorBlinkRate /t REG_SZ /d -1 /f' },
        { name: "Disable Transparency", desc: "Solid colors for better performance", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v EnableTransparency /t REG_DWORD /d 0 /f' },
        { name: "Reduce Boot Timeout", desc: "Faster OS selection timeout", cmd: 'bcdedit /timeout 3' },
        { name: "Disable Startup Delay", desc: "Launch apps immediately at login", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Serialize" /v StartupDelayInMSec /t REG_DWORD /d 0 /f' },
        { name: "Disable Auto Maintenance", desc: "Stop scheduled maintenance tasks", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\Maintenance" /v MaintenanceDisabled /t REG_DWORD /d 1 /f' },
        { name: "Disable Web Search Results", desc: "Search local files only", cmd: 'reg add "HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f' },
        { name: "Disable Mouse Acceleration", desc: "Raw mouse input for gaming", cmd: 'reg add "HKCU\\Control Panel\\Mouse" /v MouseSpeed /t REG_SZ /d 0 /f\nreg add "HKCU\\Control Panel\\Mouse" /v MouseThreshold1 /t REG_SZ /d 0 /f\nreg add "HKCU\\Control Panel\\Mouse" /v MouseThreshold2 /t REG_SZ /d 0 /f' },
        { name: "Min Keyboard Delay", desc: "Minimum keyboard delay", cmd: 'reg add "HKCU\\Control Panel\\Keyboard" /v KeyboardDelay /t REG_SZ /d 0 /f' },
        { name: "Max Keyboard Repeat", desc: "Maximum repeat rate", cmd: 'reg add "HKCU\\Control Panel\\Keyboard" /v KeyboardSpeed /t REG_SZ /d 31 /f' },
        { name: "Disable Power Throttling", desc: "Full CPU power always", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Power\\PowerThrottling" /v PowerThrottlingOff /t REG_DWORD /d 1 /f' },
        { name: "Faster App Shutdown", desc: "Apps close faster (2 seconds)", cmd: 'reg add "HKCU\\Control Panel\\Desktop" /v WaitToKillAppTimeout /t REG_SZ /d 2000 /f' },
        { name: "Faster Hung App Kill", desc: "Detect hung apps faster", cmd: 'reg add "HKCU\\Control Panel\\Desktop" /v HungAppTimeout /t REG_SZ /d 2000 /f' },
        { name: "Disable USB Selective Suspend", desc: "Keep USB devices always powered", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Services\\USB" /v DisableSelectiveSuspend /t REG_DWORD /d 1 /f' },
        { name: "NVMe Driver Experimental", desc: "Enables experimental NVMe driver stack", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\FeatureManagement\\Overrides" /v 735209102 /t REG_DWORD /d 1 /f\nreg add "HKLM\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\FeatureManagement\\Overrides" /v 1853569164 /t REG_DWORD /d 1 /f\nreg add "HKLM\\SYSTEM\\CurrentControlSet\\Policies\\Microsoft\\FeatureManagement\\Overrides" /v 156965516 /t REG_DWORD /d 1 /f' }
    ],

    // ===================================================================================
    // POWER MANAGEMENT - From HamTweak.ps1
    // ===================================================================================
    power: [
        { name: "Enable Fast Startup", desc: "Hybrid boot for faster startup", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Power" /v HiberbootEnabled /t REG_DWORD /d 1 /f' },
        { name: "Enable Hibernation", desc: "Allow hibernation mode", cmd: 'powercfg /h on' },
        { name: "Disable Hibernation", desc: "Disable to save disk space", cmd: 'powercfg /h off' },
        { name: "High Performance Plan", desc: "Maximum performance power plan", cmd: 'powercfg /setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c' },
        { name: "Balanced Power Plan", desc: "Balance performance and battery", cmd: 'powercfg /setactive 381b4222-f694-41f0-9685-ff5bb260df2e' },
        { name: "Ultimate Performance Plan", desc: "Extreme performance (creates plan)", cmd: 'powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61' },
        { name: "Never Turn Off Display", desc: "Keep monitor always on", cmd: 'powercfg /change monitor-timeout-ac 0' },
        { name: "Disable Adaptive Brightness", desc: "Manual brightness control only", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SensorState\\Sensors\\{BF16F0E4-AF24-46BE-A26E-D76A1C0F0F1A}" /v Active /t REG_DWORD /d 0 /f' },
        { name: "Never Sleep (Plugged In)", desc: "Disable sleep on AC power", cmd: 'powercfg /change standby-timeout-ac 0' },
        { name: "Never Sleep (Battery)", desc: "Disable sleep on battery", cmd: 'powercfg /change standby-timeout-dc 0' },
        { name: "Disable Wake Timers", desc: "Prevent scheduled wake-ups", cmd: 'powercfg /setacvalueindex SCHEME_CURRENT SUB_SLEEP RTCWAKE 0' },
        { name: "Disable USB Selective Suspend", desc: "Keep USB devices always powered", cmd: 'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Services\\USB" /v DisableSelectiveSuspend /t REG_DWORD /d 1 /f' },
        { name: "Max CPU Performance", desc: "CPU always at 100%", cmd: 'powercfg /setacvalueindex SCHEME_CURRENT SUB_PROCESSOR PROCTHROTTLEMAX 100' },
        { name: "Min CPU to 5%", desc: "Allow CPU to idle low", cmd: 'powercfg /setacvalueindex SCHEME_CURRENT SUB_PROCESSOR PROCTHROTTLEMIN 5' },
        { name: "Never Turn Off Hard Disk", desc: "Keep HDD spinning", cmd: 'powercfg /change disk-timeout-ac 0' },
        { name: "Lid Close Does Nothing", desc: "No action when closing laptop lid", cmd: 'powercfg /setacvalueindex SCHEME_CURRENT SUB_BUTTONS LIDACTION 0' },
        { name: "Power Button Shuts Down", desc: "Pressing power button shuts down", cmd: 'powercfg /setacvalueindex SCHEME_CURRENT SUB_BUTTONS PBUTTONACTION 3' }
    ],

    // ===================================================================================
    // UI & APPEARANCE - From HamTweak.ps1
    // ===================================================================================
    ui: [
        { name: "Enable Dark Mode", desc: "System-wide dark theme", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v AppsUseLightTheme /t REG_DWORD /d 0 /f\nreg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v SystemUsesLightTheme /t REG_DWORD /d 0 /f' },
        { name: "Enable Light Mode", desc: "System-wide light theme", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v AppsUseLightTheme /t REG_DWORD /d 1 /f\nreg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v SystemUsesLightTheme /t REG_DWORD /d 1 /f' },
        { name: "Disable Transparency Effects", desc: "Solid colors for better performance", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v EnableTransparency /t REG_DWORD /d 0 /f' },
        { name: "Show Accent on Taskbar", desc: "Colored taskbar and Start menu", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v ColorPrevalence /t REG_DWORD /d 1 /f' },
        { name: "Taskbar Left Alignment (W11)", desc: "Move taskbar icons to left", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarAl /t REG_DWORD /d 0 /f' },
        { name: "Taskbar Center Alignment (W11)", desc: "Center taskbar icons", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarAl /t REG_DWORD /d 1 /f' },
        { name: "Small Taskbar Icons", desc: "Smaller taskbar buttons", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarSmallIcons /t REG_DWORD /d 1 /f' },
        { name: "Show Taskbar Labels", desc: "Display app names on taskbar", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarGlomLevel /t REG_DWORD /d 2 /f' },
        { name: "Hide Widgets Button", desc: "Remove widgets from taskbar", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarDa /t REG_DWORD /d 0 /f' },
        { name: "Hide Chat Button", desc: "Remove Teams chat from taskbar", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarMn /t REG_DWORD /d 0 /f' },
        { name: "Hide Task View Button", desc: "Remove virtual desktops button", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 0 /f' },
        { name: "Hide Search Box", desc: "Remove search from taskbar", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v SearchboxTaskbarMode /t REG_DWORD /d 0 /f' },
        { name: "Search Icon Only", desc: "Show search as icon", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v SearchboxTaskbarMode /t REG_DWORD /d 1 /f' },
        { name: "Hide News and Interests", desc: "Remove news feed from taskbar", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Feeds" /v ShellFeedsTaskbarViewMode /t REG_DWORD /d 2 /f' },
        { name: "Hide Cortana Button", desc: "Remove Cortana from taskbar", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v ShowCortanaButton /t REG_DWORD /d 0 /f' },
        { name: "Enable End Task (W11)", desc: "Right-click to kill apps from taskbar", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\TaskbarDeveloperSettings" /v TaskbarEndTask /t REG_DWORD /d 1 /f' },
        { name: "Hide Start Menu Suggestions", desc: "No app recommendations in Start", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SystemPaneSuggestionsEnabled /t REG_DWORD /d 0 /f' },
        { name: "Hide Recent Apps in Start", desc: "Dont show recently added apps", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Start" /v ShowRecentList /t REG_DWORD /d 0 /f' },
        { name: "Disable Bing in Start Search", desc: "Local search results only", cmd: 'reg add "HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f' },
        { name: "Show File Extensions", desc: "Display .exe, .txt, etc.", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v HideFileExt /t REG_DWORD /d 0 /f' },
        { name: "Show Hidden Files", desc: "Display hidden files and folders", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v Hidden /t REG_DWORD /d 1 /f' },
        { name: "Show System Files", desc: "Display protected system files", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v ShowSuperHidden /t REG_DWORD /d 1 /f' },
        { name: "Enable Item Checkboxes", desc: "Checkboxes for file selection", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v AutoCheckSelect /t REG_DWORD /d 1 /f' },
        { name: "Show Full Path in Title", desc: "Display full folder path", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CabinetState" /v FullPath /t REG_DWORD /d 1 /f' },
        { name: "Classic Context Menu (W11)", desc: "Old right-click menu style", cmd: 'reg add "HKCU\\SOFTWARE\\Classes\\CLSID\\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\\InprocServer32" /v "" /t REG_SZ /d "" /f' },
        { name: "Open Explorer to This PC", desc: "Start in This PC not Quick Access", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v LaunchTo /t REG_DWORD /d 1 /f' },
        { name: "Hide Recent in Quick Access", desc: "Dont show recent files", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer" /v ShowRecent /t REG_DWORD /d 0 /f' },
        { name: "Hide Frequent in Quick Access", desc: "Dont show frequent folders", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer" /v ShowFrequent /t REG_DWORD /d 0 /f' },
        { name: "Disable Tips and Suggestions", desc: "No Windows tip notifications", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SoftLandingEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Welcome Experience", desc: "Skip Windows welcome screens", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SubscribedContent-310093Enabled /t REG_DWORD /d 0 /f' }
    ],

    // ===================================================================================
    // SERVICES - From HamTweak.ps1
    // ===================================================================================
    services: [
        { name: "Disable Windows Search (RISK)", desc: "Stop search indexing", cmd: 'sc config WSearch start= disabled', risk: true },
        { name: "Disable SysMain/Superfetch (RISK)", desc: "Stop prefetching", cmd: 'sc config SysMain start= disabled', risk: true },
        { name: "Disable BITS", desc: "Background file transfers", cmd: 'sc config BITS start= demand' },
        { name: "Disable DiagTrack (RISK)", desc: "Stop telemetry collection", cmd: 'sc config DiagTrack start= disabled', risk: true },
        { name: "Disable WAP Push", desc: "Stop dmwappushservice", cmd: 'sc config dmwappushservice start= disabled' },
        { name: "Disable Diagnostic Service", desc: "Diagnostic Policy Service", cmd: 'sc config DPS start= demand' },
        { name: "Disable Remote Registry", desc: "Block remote registry access", cmd: 'sc config RemoteRegistry start= disabled' },
        { name: "Disable Remote Access", desc: "Routing and Remote Access", cmd: 'sc config RemoteAccess start= disabled' },
        { name: "Disable Remote Desktop", desc: "Terminal Services", cmd: 'sc config TermService start= disabled' },
        { name: "Disable Xbox Auth", desc: "Xbox Live Auth Manager", cmd: 'sc config XblAuthManager start= disabled' },
        { name: "Disable Xbox Game Save", desc: "Xbox Live Game Save", cmd: 'sc config XblGameSave start= disabled' },
        { name: "Disable Xbox Networking", desc: "Xbox Live Networking Service", cmd: 'sc config XboxNetApiSvc start= disabled' },
        { name: "Disable Xbox Accessory", desc: "Xbox Accessory Management", cmd: 'sc config XboxGipSvc start= disabled' },
        { name: "Disable Print Spooler (RISK)", desc: "No printing support", cmd: 'sc config Spooler start= disabled', risk: true },
        { name: "Disable Geolocation", desc: "Location services", cmd: 'sc config lfsvc start= disabled' },
        { name: "Disable Map Downloads", desc: "Offline maps service", cmd: 'sc config MapsBroker start= disabled' },
        { name: "Disable Phone Service", desc: "Phone integration service", cmd: 'sc config PhoneSvc start= disabled' },
        { name: "Disable Retail Demo", desc: "Store demo mode service", cmd: 'sc config RetailDemo start= disabled' },
        { name: "Disable Wallet Service", desc: "Microsoft Wallet", cmd: 'sc config WalletService start= disabled' },
        { name: "Disable Media Sharing", desc: "Windows Media Player Network", cmd: 'sc config WMPNetworkSvc start= disabled' },
        { name: "Disable Sync Host", desc: "OneDrive/Contacts sync", cmd: 'sc config OneSyncSvc start= disabled' },
        { name: "Disable Insider Service", desc: "Windows Insider Program", cmd: 'sc config wisvc start= disabled' },
        { name: "Disable Error Reporting Svc", desc: "Windows Error Reporting", cmd: 'sc config WerSvc start= disabled' }
    ],

    // ===================================================================================
    // WINDOWS UPDATES - From HamTweak.ps1
    // ===================================================================================
    updates: [
        { name: "Auto Updates Normal", desc: "Standard Windows Update behavior", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v NoAutoUpdate /t REG_DWORD /d 0 /f\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v AUOptions /t REG_DWORD /d 3 /f' },
        { name: "Notify Before Download", desc: "Ask before downloading updates", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v AUOptions /t REG_DWORD /d 2 /f' },
        { name: "Disable Auto Updates (RISK)", desc: "Stops all automatic updates", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v NoAutoUpdate /t REG_DWORD /d 1 /f', risk: true },
        { name: "Disable P2P Delivery", desc: "Download only from Microsoft", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeliveryOptimization" /v DODownloadMode /t REG_DWORD /d 0 /f' },
        { name: "Local P2P Only", desc: "Share updates on local network", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeliveryOptimization" /v DODownloadMode /t REG_DWORD /d 1 /f' },
        { name: "Metered Connection", desc: "Treat as metered to limit updates", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\DefaultMediaCost" /v Ethernet /t REG_DWORD /d 2 /f' },
        { name: "No Auto Restart", desc: "Dont restart without permission", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v NoAutoRebootWithLoggedOnUsers /t REG_DWORD /d 1 /f' },
        { name: "Defer Feature Updates 365 Days", desc: "Delay new features 365 days", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" /v DeferFeatureUpdates /t REG_DWORD /d 1 /f\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" /v DeferFeatureUpdatesPeriodInDays /t REG_DWORD /d 365 /f' },
        { name: "Defer Quality Updates 30 Days", desc: "Delay patches 30 days", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" /v DeferQualityUpdates /t REG_DWORD /d 1 /f\nreg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" /v DeferQualityUpdatesPeriodInDays /t REG_DWORD /d 30 /f' },
        { name: "Disable Driver Updates", desc: "Dont auto-update drivers", cmd: 'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" /v ExcludeWUDriversInQualityUpdate /t REG_DWORD /d 1 /f' }
    ],

    // ===================================================================================
    // NOTIFICATIONS & SOUND - From HamTweak.ps1
    // ===================================================================================
    notifications: [
        { name: "Disable All Notifications", desc: "Turn off all system notifications", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications" /v ToastEnabled /t REG_DWORD /d 0 /f' },
        { name: "Hide Lock Screen Notifications", desc: "No notifications on lock screen", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Notifications\\Settings" /v NOC_GLOBAL_SETTING_ALLOW_TOASTS_ABOVE_LOCK /t REG_DWORD /d 0 /f' },
        { name: "Disable Notification Sounds", desc: "Silent notifications", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Notifications\\Settings" /v NOC_GLOBAL_SETTING_ALLOW_NOTIFICATION_SOUND /t REG_DWORD /d 0 /f' },
        { name: "Disable Tips Notifications", desc: "No Windows tips", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SoftLandingEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Welcome Experience", desc: "Skip Windows welcome dialogs", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SubscribedContent-310093Enabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Finish Setup Reminders", desc: "Stop setup completion nags", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UserProfileEngagement" /v ScoobeSystemSettingEnabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Suggested Content", desc: "No suggestions in Settings", cmd: 'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v SubscribedContent-338393Enabled /t REG_DWORD /d 0 /f' },
        { name: "Disable Startup Sound", desc: "No sound on Windows boot", cmd: 'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\LogonUI\\BootAnimation" /v DisableStartupSound /t REG_DWORD /d 1 /f' },
        { name: "No Sound Scheme", desc: "Disable all system sounds", cmd: 'reg add "HKCU\\AppEvents\\Schemes" /v "" /t REG_SZ /d ".None" /f' }
    ],

    // ===================================================================================
    // BLOATWARE REMOVAL
    // ===================================================================================
    bloatware: [
        { name: "Remove Bing News", desc: "Uninstalls Bing News", cmd: 'Get-AppxPackage *BingNews* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Bing Weather", desc: "Uninstalls Weather app", cmd: 'Get-AppxPackage *BingWeather* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Xbox Gaming", desc: "Uninstalls Xbox app", cmd: 'Get-AppxPackage *GamingApp* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Xbox Game Bar", desc: "Uninstalls Game Bar", cmd: 'Get-AppxPackage *XboxGamingOverlay* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Get Help", desc: "Uninstalls Help app", cmd: 'Get-AppxPackage *GetHelp* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Get Started", desc: "Uninstalls Get Started", cmd: 'Get-AppxPackage *GetStarted* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Office Hub", desc: "Uninstalls Office Hub", cmd: 'Get-AppxPackage *MicrosoftOfficeHub* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Solitaire", desc: "Uninstalls Solitaire", cmd: 'Get-AppxPackage *SolitaireCollection* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove People App", desc: "Uninstalls Contacts", cmd: 'Get-AppxPackage *People* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Power Automate", desc: "Uninstalls automation", cmd: 'Get-AppxPackage *PowerAutomateDesktop* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove To Do", desc: "Uninstalls Microsoft To Do", cmd: 'Get-AppxPackage *Todos* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Windows Alarms", desc: "Uninstalls Alarms app", cmd: 'Get-AppxPackage *WindowsAlarms* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Feedback Hub", desc: "Uninstalls Feedback app", cmd: 'Get-AppxPackage *WindowsFeedbackHub* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Windows Maps", desc: "Uninstalls Maps app", cmd: 'Get-AppxPackage *WindowsMaps* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Sound Recorder", desc: "Uninstalls Recorder", cmd: 'Get-AppxPackage *SoundRecorder* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Your Phone", desc: "Uninstalls Your Phone", cmd: 'Get-AppxPackage *YourPhone* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Zune Video", desc: "Uninstalls Movies & TV", cmd: 'Get-AppxPackage *ZuneVideo* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Zune Music", desc: "Uninstalls Zune Music", cmd: 'Get-AppxPackage *ZuneMusic* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Windows Camera", desc: "Uninstalls Camera app", cmd: 'Get-AppxPackage *WindowsCamera* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Photos", desc: "Uninstalls Photos app", cmd: 'Get-AppxPackage *Photos* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Mixed Reality", desc: "Uninstalls MR Viewer", cmd: 'Get-AppxPackage *MixedReality* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove 3D Builder", desc: "Uninstalls 3D tool", cmd: 'Get-AppxPackage *3DBuilder* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove OneNote", desc: "Uninstalls OneNote", cmd: 'Get-AppxPackage *OneNote* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Skype", desc: "Uninstalls Skype app", cmd: 'Get-AppxPackage *SkypeApp* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Remote Desktop", desc: "Uninstalls RDP", cmd: 'Get-AppxPackage *RemoteDesktop* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Print 3D", desc: "Uninstalls 3D Print", cmd: 'Get-AppxPackage *Print3D* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Xbox Overlay", desc: "Uninstalls overlay", cmd: 'Get-AppxPackage *XboxGameOverlay* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Whiteboard", desc: "Uninstalls Whiteboard", cmd: 'Get-AppxPackage *Whiteboard* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Family", desc: "Uninstalls Family app", cmd: 'Get-AppxPackage *Family* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Mail", desc: "Uninstalls Mail app", cmd: 'Get-AppxPackage *Mail* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Calendar", desc: "Uninstalls Calendar", cmd: 'Get-AppxPackage *Calendar* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Cortana", desc: "Removes Cortana", cmd: 'Get-AppxPackage *Cortana* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove OneDrive", desc: "Removes OneDrive", cmd: 'Get-AppxPackage *OneDrive* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Clipchamp", desc: "Uninstalls Clipchamp", cmd: 'Get-AppxPackage *Clipchamp* | Remove-AppxPackage -ErrorAction SilentlyContinue' },
        { name: "Remove Microsoft Teams", desc: "Uninstalls Teams", cmd: 'Get-AppxPackage *Teams* | Remove-AppxPackage -ErrorAction SilentlyContinue' }
    ]
};

const categoryIcons = {
    privacy: "üîí",
    performance: "‚ö°",
    power: "üîã",
    ui: "üé®",
    services: "‚öôÔ∏è",
    updates: "üîÑ",
    notifications: "üîî",
    bloatware: "üßπ"
};

let currentFilter = "";
let selectedIds = new Set();

function buildCategories() {
    const container = document.getElementById("categoriesContainer");
    container.innerHTML = "";

    Object.keys(tweaksData).forEach(catKey => {
        const tweaks = tweaksData[catKey];

        const block = document.createElement("div");
        block.className = "category-block";

        const head = document.createElement("div");
        head.className = "category-head";
        head.onclick = () => {
            const list = block.querySelector(".tweaks-list");
            list.style.display = list.style.display === "none" ? "block" : "none";
        };

        const left = document.createElement("div");
        left.className = "category-head-left";

        const iconSpan = document.createElement("span");
        iconSpan.textContent = categoryIcons[catKey] || "‚Ä¢";

        const titleSpan = document.createElement("span");
        titleSpan.className = "category-head-title";
        titleSpan.textContent = catKey.charAt(0).toUpperCase() + catKey.slice(1);

        left.appendChild(iconSpan);
        left.appendChild(titleSpan);

        const countBadge = document.createElement("span");
        countBadge.className = "category-pill";
        countBadge.textContent = `${tweaks.length} tweaks`;

        const chevron = document.createElement("span");
        chevron.className = "category-chevron";
        chevron.textContent = "‚ñæ";

        head.appendChild(left);
        head.appendChild(countBadge);
        head.appendChild(chevron);

        const list = document.createElement("div");
        list.className = "tweaks-list";

        tweaks.forEach((t, index) => {
            const id = `${catKey}-${index}`;
            const item = document.createElement("div");
            item.className = "tweak-item";

            const cb = document.createElement("input");
            cb.type = "checkbox";
            cb.id = id;
            cb.checked = selectedIds.has(id);
            cb.onclick = e => {
                e.stopPropagation();
                toggleSelection(id);
            };

            const info = document.createElement("div");
            info.className = "tweak-main";

            const nameDiv = document.createElement("div");
            nameDiv.className = "tweak-name";
            nameDiv.textContent = t.name;

            const descDiv = document.createElement("div");
            descDiv.className = "tweak-desc";
            descDiv.textContent = t.desc;

            info.appendChild(nameDiv);
            info.appendChild(descDiv);

            item.appendChild(cb);
            item.appendChild(info);
            item.onclick = () => {
                cb.checked = !cb.checked;
                toggleSelection(id);
            };

            list.appendChild(item);
        });

        block.appendChild(head);
        block.appendChild(list);
        container.appendChild(block);
    });

    updateStats();
    regenerateScript();
}

function toggleSelection(id) {
    if (selectedIds.has(id)) {
        selectedIds.delete(id);
    } else {
        selectedIds.add(id);
    }
    updateStats();
    regenerateScript();
}

function updateStats() {
    let p = tweaksData.privacy.length;
    let perf = tweaksData.performance.length;
    let pwr = tweaksData.power.length;
    let u = tweaksData.ui.length;
    let s = tweaksData.services.length;
    let upd = tweaksData.updates.length;
    let n = tweaksData.notifications.length;
    let b = tweaksData.bloatware.length;

    document.getElementById("statPrivacy").textContent = p;
    document.getElementById("statPerformance").textContent = perf;
    document.getElementById("statPower").textContent = pwr;
    document.getElementById("statUi").textContent = u;
    document.getElementById("statServices").textContent = s;
    document.getElementById("statUpdates").textContent = upd;
    document.getElementById("statNotifications").textContent = n;
    document.getElementById("statBloatware").textContent = b;

    document.getElementById("totalCountLabel").textContent = p + perf + pwr + u + s + upd + n + b;
    document.getElementById("selectedCountLabel").textContent = selectedIds.size;
}

function regenerateScript() {
    if (!selectedIds.size) {
        document.getElementById("scriptCode").textContent =
            "# Select tweaks on the left to generate a script...";
        return;
    }
    let lines = [];
    lines.push('Write-Host "CookedHamTweaker ‚Äì Applying selected tweaks..." -ForegroundColor Magenta');
    lines.push('Write-Host "Running as Administrator is strongly recommended.`n" -ForegroundColor Yellow');

    selectedIds.forEach(id => {
        const [cat, indexStr] = id.split("-");
        const idx = parseInt(indexStr, 10);
        const t = tweaksData[cat][idx];
        if (t && t.cmd) {
            // Handle commands that contain newlines or semicolons
            const cmds = t.cmd.split(/\n|;/).map(c => c.trim()).filter(c => c);
            cmds.forEach(c => lines.push(c));
        }
    });

    lines.push("");
    lines.push('Write-Host "`nAll selected tweaks have been executed. A reboot is recommended." -ForegroundColor Green');

    document.getElementById("scriptCode").textContent = lines.join("\n");
}

function selectAllTweaks() {
    selectedIds.clear();
    Object.keys(tweaksData).forEach(cat => {
        tweaksData[cat].forEach((_, idx) => {
            selectedIds.add(`${cat}-${idx}`);
        });
    });
    buildCategories();
}

function clearAllTweaks() {
    selectedIds.clear();
    buildCategories();
}

function copyScript() {
    const text = document.getElementById("scriptCode").textContent;
    navigator.clipboard.writeText(text).then(() => {
        alert("Script copied to clipboard.");
    });
}

function downloadScript() {
    const text = document.getElementById("scriptCode").textContent;
    const blob = new Blob([text], { type: "text/plain" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "CookedHamTweaker.ps1";
    a.click();
    URL.revokeObjectURL(url);
}

function clearScript() {
    selectedIds.clear();
    buildCategories();
}

// Profile selection
document.getElementById("profileSelect").addEventListener("change", e => {
    const val = e.target.value;
    selectedIds.clear();

    if (val === "privacy") {
        tweaksData.privacy.forEach((_, i) => selectedIds.add(`privacy-${i}`));
        tweaksData.notifications.forEach((_, i) => selectedIds.add(`notifications-${i}`));
    } else if (val === "gaming") {
        tweaksData.performance.forEach((_, i) => selectedIds.add(`performance-${i}`));
        tweaksData.power.forEach((_, i) => selectedIds.add(`power-${i}`));
        tweaksData.ui.forEach((_, i) => selectedIds.add(`ui-${i}`));
        tweaksData.services.forEach((_, i) => selectedIds.add(`services-${i}`));
    } else if (val === "balanced") {
        Object.keys(tweaksData).forEach(cat => {
            tweaksData[cat].forEach((_, i) => {
                if (Math.random() > 0.5) selectedIds.add(`${cat}-${i}`);
            });
        });
    } else if (val === "maximum") {
        selectAllTweaks();
        return;
    }

    buildCategories();
});

// Search filter
document.getElementById("searchInput").addEventListener("input", e => {
    currentFilter = e.target.value.toLowerCase();
    const container = document.getElementById("categoriesContainer");
    const blocks = container.querySelectorAll(".category-block");

    blocks.forEach((block, catIdx) => {
        const catKey = Object.keys(tweaksData)[catIdx];
        const list = block.querySelector(".tweaks-list");
        const items = list.querySelectorAll(".tweak-item");

        items.forEach((item, idx) => {
            const t = tweaksData[catKey][idx];
            const hay = (t.name + " " + t.desc).toLowerCase();
            item.style.display = currentFilter && !hay.includes(currentFilter) ? "none" : "flex";
        });
    });
});

// init
buildCategories();
</script>
</body>
</html>
